@model SearchModel
<!-- MAIN CONTENT -->
<div id="content">
    @{ Html.RenderPartialIf("_MiniDashboard", Settings.EnableMiniDashborad); }

    <div class="row">

        <div class="col-sm-12">

            @*<ul id="myTab1" class="nav nav-tabs bordered">
            <li class="active">
            <a href="#s1" data-toggle="tab">Search All <i class="fa fa-caret-down"></i></a>
            </li>
            <li>
            <a href="#s2" data-toggle="tab">Users</a>
            </li>
            <li>
            <a href="#s3" data-toggle="tab">Search History</a>
            </li>
            <li class="pull-right hidden-mobile">
            <a href="javascript:void(0);"> <span class="note">About 24,431 results (0.15 seconds) </span> </a>
            </li>
            </ul>*@

            <div id="myTabContent1" class="tab-content bg-color-white padding-10">
                <div class="tab-pane fade in active" id="s1">
                    @*<h1> Search <span class="semi-bold">Everything</span></h1>*@
                    <br>

                    @using (Html.BeginForm("Search", "CRM", FormMethod.Post, new { @class = "heaght" }))
                    {
                    <div class="input-group input-group-lg hidden-mobile">

                        <input class="form-control input-lg" type="text" value="@Model.param" name="param_search" placeholder="Search again..." id="searchid">
                        <div class="input-group-btn">
                            <button type="submit" class="btn btn-default">
                                &nbsp;&nbsp;&nbsp;<i class="fa fa-fw fa-search fa-lg"></i>&nbsp;&nbsp;&nbsp;
                            </button>
                        </div>
                    </div>
                    }

                    <br />
                    <hr />
                    <h1> Resultado para <span class="semi-bold">Leads...</span> <small class="text-danger"> &nbsp;&nbsp;(@( Model.Leads.Count() ) results)</small> </h1>
                    <!-- content goes here -->
                    <table id="idtable" class="table table-striped table-bordered table-hover" width="100%">
                        <thead>
                            <tr>
                                <th style="width:100px" data-class="expand">Código</th>
                                <th data-hide="phone,tablet">Nome</th>
                                <th data-hide="phone,tablet">Email</th>
                                <th data-hide="phone,tablet">Fone</th>
                                <th data-hide="phone,tablet">Cgc/Cpf</th>
                            </tr>
                        </thead>
                        <tbody>


                            @foreach (var item in Model.Leads)
                            {
                            <tr>
                                <td> @item.cod_lead  </td>
                                <td> <a target="_blank" href="@Url.Action("Edit", "Lead", new { id = @item.cod_lead})">@item.des_nome </a>   </td>
                                <td> @item.des_email </td>
                                <td> @item.des_fone </td>
                                <td> @Html.FormataCnpj(item.des_documento ) </td>
                            </tr>

                            @*<div class="search-results clearfix smart-form">
                            <h4><spam class="text-warning">@item.des_nome</spam> <span class="semi-bold"> @item.des_sobrenome </span></h4>
                            <div>
                            <div class="email text-success">
                            @item.des_email
                            </div>
                            <p class="description">
                            @item.des_fone
                            </p>
                            <p class="description">

                            </p>
                            </div>

                            </div>*@
                            }
                        </tbody>
                    </table>




                    <br />
                    <hr />
                    <h1> Resultado para <span class="semi-bold">Contatos...</span> <small class="text-danger"> &nbsp;&nbsp;(@( Model.Contatos.Count() ) results)</small> </h1>
                    <!-- content goes here -->
                    <table id="idtable_contatos" class="table table-striped table-bordered table-hover" width="100%">
                        <thead>
                            <tr>
                                <th style="width:100px" data-class="expand">Código</th>
                                <th data-hide="phone,tablet">Nome</th>
                                <th data-hide="phone,tablet">Cd. Empresa</th>
                                <th data-hide="phone,tablet">Empresa</th>
                                <th data-hide="phone,tablet">Email</th>
                                <th data-hide="phone,tablet">Fone</th>
                                <th data-hide="phone,tablet">Cgc/Cpf</th>
                            </tr>
                        </thead>
                        <tbody>


                            @foreach (var item in Model.Contatos)
                            {
                                <tr>
                                    <td> <a target="_blank" href="@Url.Action("Edit", "Contacts", new { id = @item.cod_contato})">@item.cod_contato </a>   </td>
                                    <td> <a target="_blank" href="@Url.Action("Edit", "Contacts", new { id = @item.cod_contato})">@item.des_nome </a>   </td>
                                    <td> @item.cod_empresa </td>
                                    <td> @item.des_empresa </td>
                                    <td> @item.des_email </td>
                                    <td> @item.des_fone </td>
                                    <td> @Html.FormataCnpj(item.cnpj) </td>
                                </tr>
                            }
                        </tbody>
                    </table>






                    <br />
                    <hr />
                    <h1> Resultado para <span class="semi-bold">Sac...</span> <small class="text-danger"> &nbsp;&nbsp;(@*@( Model.Sac.Count() )*@ results)</small> </h1>
                    <!-- content goes here -->
                    <table id="idtable_sac" class="table table-striped table-bordered table-hover" width="100%">
                        <thead>
                            <tr>
                                <th style="width:100px" data-class="expand">Código</th>
                                <th data-hide="phone,tablet">Cd. Pessoa</th>
                                <th data-hide="phone,tablet">Pessoa</th>
                                <th data-hide="phone,tablet">Assunto</th>
                            </tr>
                        </thead>
                        <tbody>


                            @*@foreach (var item in Model.Sac)
                            {
                                <tr>
                                    <td> <a href="javascript:void(0);">@item.cod_sac</a> </td>
                                    <td> @item.cod_pessoa </td>
                                    <td> @item.des_pessoa </td>
                                    <td> @item.des_assunto </td>
                                </tr>
                            }*@
                        </tbody>
                    </table>





                    <br />
                    <hr />
                    <h1> Resultado para <span class="semi-bold">Garantias...</span> <small class="text-danger"> &nbsp;&nbsp;(@*@( Model.Garantia.Count() )*@ results)</small> </h1>
                    <!-- content goes here -->
                    <table id="idtable_garantia" class="table table-striped table-bordered table-hover" width="100%">
                        <thead>
                            <tr>
                                <th style="width:100px" data-class="expand">Código</th>
                                <th data-hide="phone,tablet">Cd. Representante</th>
                                <th data-hide="phone,tablet">Cd. Pessoa</th>
                                <th data-hide="phone,tablet">Pessoa</th>
                                <th data-hide="phone,tablet">NF</th>
                            </tr>
                        </thead>
                        <tbody>


                            @*@foreach (var item in Model.Garantia)
                            {
                                <tr>
                                    <td> <a href="javascript:void(0);">@item.garantiaid</a> </td>
                                    <td> @item.cod_representante </td>
                                    <td> @item.des_pessoa </td>
                                    <td> @item.des_pessoa </td>
                                    <td> @item.num_nf_cliente </td>
                                </tr>
                            }*@
                        </tbody>
                    </table>


                    <br />
                    <hr />
                    <h1> Resultado para <span class="semi-bold">Pessoas...</span> <small class="text-danger"> &nbsp;&nbsp;(@( Model.Pessoas.Count() ) results)</small> </h1>
                    <!-- content goes here -->
                    <table id="idtable_pessoas" class="table table-striped table-bordered table-hover" width="100%">
                        <thead>
                            <tr>
                                <th style="width:100px" data-class="expand">Código</th>
                                <th data-hide="phone,tablet">Pessoa</th>
                                <th data-hide="phone,tablet">Email</th>
                            </tr>
                        </thead>
                        <tbody>


                            @foreach (var item in Model.Pessoas)
                            {
                                <tr>
                                    <td> <a target="_blank" href="@Url.Action("ViewProfile", "Account", new { id = @item.cod_pessoa})">@item.cod_pessoa </a>   </td>
                                    <td> <a target="_blank" href="@Url.Action("ViewProfile", "Account", new { id = @item.cod_pessoa})">@item.des_pessoa </a>   </td>
                                    <td> @item.des_email </td>
                                </tr>
                            }
                        </tbody>
                    </table>




                </div>













            </div>

        </div>

    </div>

    <!-- end row -->

</div>


@section pagespecific {
<script>
    pageSetUpTableSearch("idtable", 10);
    pageSetUpTableSearch("idtable_contatos", 10);
    //pageSetUpTableSearch("idtable_sac", 10);
    //pageSetUpTableSearch("idtable_garantia", 10);
    pageSetUpTableSearch("idtable_pessoas", 10);
    
    
    

</script>

<script>



    $(document).ready(function () {



        var responsiveHelper_datatable_col_reorder = undefined;

        var breakpointDefinition = {
            tablet: 1024,
            phone: 480
        };

        var par = document.getElementById("searchid").value;

        var url = "/CRM/GetGarantia/?param_search=" + par;



        /* COLUMN SHOW - HIDE */
        var otable = $('#idtable_garantia').DataTable({

            // Tabletools options:
            //   https://datatables.net/extensions/tabletools/button_options
            "sDom": "<'dt-toolbar'<'col-xs-12 col-sm-6'><'col-sm-6 col-xs-6 hidden-xs'>r>" +
                    "t" +
                    "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",
            //"oTableTools": {
            //    "aButtons": [
            //    "copy",
            //    "csv",
            //       {
            //           "sExtends": "print",
            //           "sMessage": "Generated by CRM <i>(press Esc to close)</i>"
            //       }
            //    ],
            //    "sSwfPath": "/Scripts/plugin/datatables/swf/copy_csv_xls_pdf.swf"
            //},
            "autoWidth": true,
            "preDrawCallback": function () {
                // Initialize the responsive datatables helper once.
                if (!responsiveHelper_datatable_col_reorder) {
                    responsiveHelper_datatable_col_reorder = new ResponsiveDatatablesHelper($('#idtable_garantia'), breakpointDefinition);
                }
            },
            "rowCallback": function (nRow) {
                responsiveHelper_datatable_col_reorder.createExpandIcon(nRow);
            },
            "drawCallback": function (oSettings) {
                responsiveHelper_datatable_col_reorder.respond();
            },
            "bServerSide": true,
            "sAjaxSource": url,
            //"searchDelay": 3000,
            "bProcessing": true,
            "pageLength": 10,
            "ordering": false,
            //  "columnDefs": [
            //    { targets: 'no-sort', orderable: false }
            //  ],


            "aoColumns": [
                           { "data": "garantiaid", "mRender": function (data, type, full) { return '<a target="_blank" href=\"../Garantias/Details/' + full.garantiaid + '\">' + full.garantiaid + '</a>'; } },
                           { "data": "cod_representante" },
                           //{ "data": "des_item", "mRender": function (data, type, full) { return '<a href=\"#' + full.cod_foxlux + '\">' + full.des_item + '</a>'; } },
                           { "data": "cod_cliente", "mRender": function (data, type, full) { return '<a target="_blank" href=\"../Account/ViewProfile/' + full.cod_cliente + '\">' + full.cod_cliente + '</a>'; } },
                           { "data": "des_pessoa" },
                           { "data": "num_nf_cliente" }]
        });



    })



        $(document).ready(function () {



            var responsiveHelper_datatable_col_reorder = undefined;

            var breakpointDefinition = {
                tablet: 1024,
                phone: 480
            };

            var par = document.getElementById("searchid").value;

            var url = "/CRM/GetSac/?param_search=" + par;



            /* COLUMN SHOW - HIDE */
            var otable = $('#idtable_sac').DataTable({

                // Tabletools options:
                //   https://datatables.net/extensions/tabletools/button_options
                "sDom": "<'dt-toolbar'<'col-xs-12 col-sm-6'><'col-sm-6 col-xs-6 hidden-xs'>r>" +
                        "t" +
                        "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",
                //"oTableTools": {
                //    "aButtons": [
                //    "copy",
                //    "csv",
                //       {
                //           "sExtends": "print",
                //           "sMessage": "Generated by CRM <i>(press Esc to close)</i>"
                //       }
                //    ],
                //    "sSwfPath": "/Scripts/plugin/datatables/swf/copy_csv_xls_pdf.swf"
                //},
                "autoWidth": true,
                "preDrawCallback": function () {
                    // Initialize the responsive datatables helper once.
                    if (!responsiveHelper_datatable_col_reorder) {
                        responsiveHelper_datatable_col_reorder = new ResponsiveDatatablesHelper($('#idtable_sac'), breakpointDefinition);
                    }
                },
                "rowCallback": function (nRow) {
                    responsiveHelper_datatable_col_reorder.createExpandIcon(nRow);
                },
                "drawCallback": function (oSettings) {
                    responsiveHelper_datatable_col_reorder.respond();
                },
                "bServerSide": true,
                "sAjaxSource": url,
                //"searchDelay": 3000,
                "bProcessing": true,
                "pageLength": 10,
                "ordering": false  ,
                //  "columnDefs": [
                //    { targets: 'no-sort', orderable: false }
                //  ],


                "aoColumns": [
                               { "data": "cod_sac", "mRender": function (data, type, full) { return '<a target="_blank" href=\"../Sac/Details/' + full.cod_sac + '\">' + full.cod_sac + '</a>'; } },
                               { "data": "cod_pessoa" },
                               //{ "data": "des_item", "mRender": function (data, type, full) { return '<a href=\"#' + full.cod_foxlux + '\">' + full.des_item + '</a>'; } },
                               { "data": "des_pessoa" },
                               { "data": "des_assunto" }]
            });



        })



</script>

}